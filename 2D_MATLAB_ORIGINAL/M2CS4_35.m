function [C4,S4] = M2CS4_35(M4)
% 35 moments of order 0 to 4
% 
% central and standardized moments
C4 = 0*M4;
S4 = 0*C4;

% rearrange moment vector
M000=M4(1);
M100=M4(2);
M200=M4(3);
M300=M4(4);
M400=M4(5);
M010=M4(6);
M110=M4(7);
M210=M4(8);
M310=M4(9);
M020=M4(10);
M120=M4(11);
M220=M4(12);
M030=M4(13);
M130=M4(14);
M040=M4(15);
%
M001=M4(16);
M101=M4(17);
M201=M4(18);
M301=M4(19);
M002=M4(20);
M102=M4(21);
M202=M4(22);
M003=M4(23);
M103=M4(24);
M004=M4(25);
M011=M4(26);
M111=M4(27);
M211=M4(28);
M021=M4(29);
M121=M4(30);
%
M031=M4(31);
M012=M4(32);
M112=M4(33);
M013=M4(34);
M022=M4(35);

% compute central moments
C = M4toC4_3D(M000,M100,M200,M300,M400,M010,M110,M210,M310,M020,M120,M220,M030,M130,M040,...
              M001,M101,M201,M301,M002,M102,M202,M003,M103,M004,M011,M111,M211,M021,M121,...
              M031,M012,M112,M013,M022);


C000 = C(1,1,1);
C100 = C(2,1,1);
C010 = C(1,2,1);
C001 = C(1,1,2);
%
C200 = C(3,1,1);
C110 = C(2,2,1);
C101 = C(2,1,2);
C020 = C(1,3,1);
C011 = C(1,2,2);
C002 = C(1,1,3);
%
C300 = C(4,1,1);
C210 = C(3,2,1);
C201 = C(3,1,2);
C120 = C(2,3,1);
C111 = C(2,2,2);
C102 = C(2,1,3);
C030 = C(1,4,1);
C021 = C(1,3,2);
C012 = C(1,2,3);
C003 = C(1,1,4);
%
C400 = C(5,1,1);
C310 = C(4,2,1);
C301 = C(4,1,2);
C220 = C(3,3,1);
C211 = C(3,2,2);
C202 = C(3,1,3);
C130 = C(2,4,1);
C121 = C(2,3,2);
C112 = C(2,2,3);
C103 = C(2,1,4);
C040 = C(1,5,1);
C031 = C(1,4,2);
C022 = C(1,3,3);
C013 = C(1,2,4);
C004 = C(1,1,5);

% compute standardized moments
%
sC200 = sqrt(max(C200,eps));
sC020 = sqrt(max(C020,eps));
sC002 = sqrt(max(C002,eps));
%
S000 = 1;
S100 = 0;
S010 = 0;
S001 = 0;
%
S200 = 1;
S110 = C(2,2,1)/sC200/sC020;
S101 = C(2,1,2)/sC200/sC002;
S020 = 1;
S011 = C(1,2,2)/sC020/sC002;
S002 = 1;
%
S300 = C(4,1,1)/sC200^3;
S210 = C(3,2,1)/(sC200^2*sC020);
S201 = C(3,1,2)/(sC200^2*sC002);
S120 = C(2,3,1)/(sC200*sC020^2);
S111 = C(2,2,2)/(sC200*sC020*sC002);
S102 = C(2,1,3)/(sC200*sC002^2);
S030 = C(1,4,1)/sC020^3;
S021 = C(1,3,2)/(sC020^2*sC002);
S012 = C(1,2,3)/(sC020*sC002^2);
S003 = C(1,1,4)/sC002^3;
%
S400 = C(5,1,1)/sC200^4;
S310 = C(4,2,1)/(sC200^3*sC020);
S301 = C(4,1,2)/(sC200^3*sC002);
S220 = C(3,3,1)/(sC200^2*sC020^2);
S211 = C(3,2,2)/(sC200^2*sC020*sC002);
S202 = C(3,1,3)/(sC200^2*sC002^2);
S130 = C(2,4,1)/(sC200*sC020^3);
S121 = C(2,3,2)/(sC200*sC020^2*sC002);
S112 = C(2,2,3)/(sC200*sC020*sC002^2);
S103 = C(2,1,4)/(sC200*sC002^3);
S040 = C(1,5,1)/sC020^4;
S031 = C(1,4,2)/(sC020^3*sC002);
S022 = C(1,3,3)/(sC020^2*sC002^2);
S013 = C(1,2,4)/(sC020*sC002^3);
S004 = C(1,1,5)/sC002^4;

C4(1) = C000;
C4(2) = C100;
C4(3) = C200;
C4(4) = C300;
C4(5) = C400;
C4(6) = C010;
C4(7) = C110;
C4(8) = C210;
C4(9) = C310;
C4(10)= C020;
C4(11)= C120;
C4(12)= C220;
C4(13)= C030;
C4(14)= C130;
C4(15)= C040;
%
C4(16)= C001;
C4(17)= C101;
C4(18)= C201;
C4(19)= C301;
C4(20)= C002;
C4(21)= C102;
C4(22)= C202;
C4(23)= C003;
C4(24)= C103;
C4(25)= C004;
C4(26)= C011;
C4(27)= C111;
C4(28)= C211;
C4(29)= C021;
C4(30)= C121;
%
C4(31)= C031;
C4(32)= C012;
C4(33)= C112;
C4(34)= C013;
C4(35)= C022;

S4(1) = S000;
S4(2) = S100;
S4(3) = S200;
S4(4) = S300;
S4(5) = S400;
S4(6) = S010;
S4(7) = S110;
S4(8) = S210;
S4(9) = S310;
S4(10)= S020;
S4(11)= S120;
S4(12)= S220;
S4(13)= S030;
S4(14)= S130;
S4(15)= S040;
%
S4(16)= S001;
S4(17)= S101;
S4(18)= S201;
S4(19)= S301;
S4(20)= S002;
S4(21)= S102;
S4(22)= S202;
S4(23)= S003;
S4(24)= S103;
S4(25)= S004;
S4(26)= S011;
S4(27)= S111;
S4(28)= S211;
S4(29)= S021;
S4(30)= S121;
%
S4(31)= S031;
S4(32)= S012;
S4(33)= S112;
S4(34)= S013;
S4(35)= S022;
%
end