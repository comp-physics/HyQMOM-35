% realizability regions for S220, S202, S002
clc

syms S110 S101 S011 S300 S210 S201 S120 S102 S030 S021 S012 S111 S003 real %,S310,S301,S220,S211,S202,S130,S121,S112,S103,S031,S013,S022 real
% find D matrix
%
Del1 = [1 0    0    0;...
        0 1    S110 S101;...
        0 S110 1    S011;...
        0 S101 S011 1];
%
B = [1    S300 S210 S201;...
     S110 S210 S120 S111;...
     S101 S201 S111 S102;...
     1    S120 S030 S021;...
     S011 S111 S021 S012;...
     1    S102 S012 S003];
D = B/Del1*B';
%
d11 = D(1,1);
d22 = D(2,2);
d33 = D(3,3);
d44 = D(4,4);
d55 = D(5,5);
d66 = D(6,6);
d12 = D(1,2)
d13 = D(1,3);
d14 = D(1,4);
d15 = D(1,5);
d16 = D(1,6);
d23 = D(2,3);
d24 = D(2,4);
d25 = D(2,5);
d26 = D(2,6);
d34 = D(3,4);
d35 = D(3,5);
d36 = D(3,6);
d45 = D(4,5);
d46 = D(4,6);
d56 = D(5,6);

return
syms X210 X201 X102 X012 dDel1 real
% dDel1 = -(S011^2 - 2*S011*S101*S110 + S101^2 + S110^2 - 1);

% S210 = (X210 + S110*S300);
% S201 = (X201 + S101*S300);

% d11 = 1 - ((X210 + S110*S300)*((X210 + S110*S300) - S011*(X201 + S101*S300) - S110*S300 - S101^2*(X210 + S110*S300) + S011*S101*S300 + S101*S110*(X201 + S101*S300)))/(-dDel1) - (S300*(S300 - S101*(X201 + S101*S300) - S110*(X210 + S110*S300) - S011^2*S300 + S011*S101*(X210 + S110*S300) + S011*S110*(X201 + S101*S300)))/(-dDel1) - ((X201 + S101*S300)*((X201 + S101*S300) - S011*(X210 + S110*S300) - S101*S300 - S110^2*(X201 + S101*S300) + S011*S110*S300 + S101*S110*(X210 + S110*S300)))/(-dDel1);
 
% d11 = collect(simplify(d11),[X210 X201])

% d11 = (-(S101^2 - 1)/dDel1)*X210^2 + (-(2*S011 - 2*S101*S110)/dDel1)*X210*X201 + (-(S110^2 - 1)/dDel1)*X201^2 + S300^2 + 1;

% S400 - d11 = H200 - (-(S101^2 - 1)/dDel1)*X210^2 + (-(2*S011 - 2*S101*S110)/dDel1)*X210*X201 + (-(S110^2 - 1)/dDel1)*X201^2 > 0
 
%d44 = 1 - (S030*(S030 - S011*S021 - S110*S120 - S030*S101^2 + S011*S101*S120 + S021*S101*S110))/(-dDel1) - (S120*(S120 - S021*S101 - S030*S110 - S011^2*S120 + S011*S021*S110 + S011*S030*S101))/(-dDel1) - (S021*(S021 - S011*S030 - S101*S120 - S021*S110^2 + S011*S110*S120 + S030*S101*S110))/(-dDel1)
 
 
% S102 = (X102 + S101*S003);
% S012 = (X012 + S011*S003);
% d66 = 1 - ((X012 + S011*S003)*((X012 + S011*S003) - S003*S011 - (X102 + S101*S003)*S110 - (X012 + S011*S003)*S101^2 + S003*S101*S110 + S011*S101*(X102 + S101*S003)))/(-dDel1) - ((X102 + S101*S003)*((X102 + S101*S003) - S003*S101 - (X012 + S011*S003)*S110 - S011^2*(X102 + S101*S003) + S003*S011*S110 + S011*(X012 + S011*S003)*S101))/(-dDel1) - (S003*(S003 - S011*(X012 + S011*S003) - S101*(X102 + S101*S003) - S003*S110^2 + S011*(X102 + S101*S003)*S110 + (X012 + S011*S003)*S101*S110))/(-dDel1);
% 
% d66 = collect(simplify(d66),[X102 X012]);
% 
% d66 = (-(S011^2 - 1)/dDel1)*X102^2 + (-(2*S110 - 2*S011*S101)/dDel1)*X102*X012 + (-(S101^2 - 1)/dDel1)*X012^2 + S003^2 + 1;
% 
% S004 - d66 = H002 - (-(S011^2 - 1)/dDel1)*X102^2 + (-(2*S110 - 2*S011*S101)/dDel1)*X102*X012 + (-(S101^2 - 1)/dDel1)*X012^2

%d12 = S110 - (S111*(S201 - S011*S210 - S101*S300 - S110^2*S201 + S011*S110*S300 + S101*S110*S210))/(-dDel1) - (S120*(S210 - S011*S201 - S110*S300 - S101^2*S210 + S011*S101*S300 + S101*S110*S201))/(-dDel1) - (S210*(S300 - S101*S201 - S110*S210 - S011^2*S300 + S011*S101*S210 + S011*S110*S201))/(-dDel1)
 
b310 = S111*((1 - S110^2)*S201 + (S101*S110 - S011)*S210 + (S011*S110 - S101)*S300) ...
     + S120*((1 - S101^2)*S210 + (S011*S101 - S110)*S300 + (S101*S110 - S011)*S201) ...
     + S210*((1 - S011^2)*S300 + (S011*S101 - S110)*S210 + (S011*S110 - S101)*S201);
 
 