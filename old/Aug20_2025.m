clear
clc

syms a b c integer
syms s3 real
syms R110 R101 R011 positive
syms s110 s101 s011 real
syms s210 s201 s120 s102 s021 s012 real
syms s300 s030 s003 s111 real

assume(s110^2 < 1)
assume(s101^2 < 1)
assume(s011^2 < 1)
%assumptions

a=-1; b=-1; c=-1;
% a=-1; b=1; c=1;
% a=1; b=-1; c=1;
% a=1; b=1; c=-1;

s3 = 1;

s110 = 0
s101 = 0

R110 = sqrt(1-s110^2)
R101 = sqrt(1-s101^2)

s011 = s110*s101+a*R110*R101
R011 = sqrt(1-s011^2)

% b = 1;
% A = [R011^2, -b*R101*R011; -b*R101*R011, R101^2];
% As = sqrtm(A)
% 
% simplify(As*As)
% 
% Y = [s102-s101*s003; s012-s011*s003]
% 
% gp1 = As*Y
% 
% return

% R101*(s210 - s110*s300) - R110*(s201 - s101*s300)=0
% R011*(s120 - s030*s110) - R110*(s021 - s011*s030)=0
% R011*(s102 - s003*s101) - R101*(s012 - s003*s011)=0
% 

X = [s210 s201 s120 s102 s021 s012 s111 s300 s030 s003]';
%
%1 c*R101*X(1) + b*R110*X(2) - R011*X(8) = 0
%2 c*R011*X(3) + a*R110*X(5) - R101*X(9) = 0
%3 b*R011*X(4) + a*R101*X(6) - R110*X(10)= 0
%4 c*R101*X(5) + b*R110*X(6) - R011*X(7) = 0
%5 c*R011*X(2) + a*R110*X(4) - R101*X(7) = 0
%6 b*R011*X(1) + a*R101*X(3) - R110*X(7) = 0
%7 R101*(X(1) - s110*X(8)) - R110*(X(2) - s101*X(8)) =0
%8 R011*(X(3) - s110*X(9)) - R110*(X(5) - s011*X(9)) =0
%9 R011*(X(4) - s101*X(10))- R101*(X(6) - s011*X(10))=0
%10 X(8) + X(9) + X(10) = s3

B = [0 0 0 0 0 0 0 0 0 3*s3]';

A=sym(zeros(10,10)); 
A(1,1)=c*R101; A(1,2)=b*R110; A(1,8)=-R011;
A(2,3)=c*R011; A(2,5)=a*R110; A(1,9)=-R101;
A(3,4)=b*R011; A(3,6)=a*R101; A(1,10)=-R110;
A(4,5)=c*R101; A(4,6)=b*R110; A(4,7) = -R011;
A(5,2)=c*R011; A(5,4)=a*R110; A(5,7) = -R101; 
A(6,1)=b*R011; A(6,3)=a*R101; A(6,7) = -R110;
A(7,1)=R101; A(7,2)=-R110; A(7,8) =R110*s101-R101*s110;
A(8,3)=R011; A(8,5)=-R110; A(8,9) =R110*s011-R011*s110;
A(9,4)=R011; A(9,6)=-R101; A(9,10)=R101*s011-R011*s101;
A(10,8)=1; A(10,9)=1; A(10,10)=1;

A
rank(A)
rank([A B])

Xp = A\B;
Xp = double(Xp);

s210 = Xp(1)
s201 = Xp(2)
s120 = Xp(3) 
s102 = Xp(4) 
s021 = Xp(5) 
s012 = Xp(6) 
s111 = Xp(7) 
s300 = Xp(8) 
s030 = Xp(9) 
s003 = Xp(10)

return

[L,U,P] = lu(A)
Ap = P*A
Bp = P*B

[Lp,Up,Pp] = lu(Ap)

Xp = pinv(A)*B;

pretty(Xp)

return

[L,U,P] = lu(A)

Ap = P*A
Bp = P*B

[Lp,Up,Pp] = lu(Ap)

Yp = Lp\Bp
LHS = Up*X
s111p = Yp(6,1)/Up(6,7)

rank(Up(1:6,1:6))

Xp = Up(1:6,1:6)\(Yp(1:6,1)-Up(1:6,7)*s111p)

% s111p = (s300*R011^3 + s030*R101^3 + s003*R110^3)/(3*R011*R101*R110)
% s111p = (- s300*R011^3 + s030*R101^3 + s003*R110^3)/(R011*R101*R110)
% s111p = (s300*R011^3 - s030*R101^3 + s003*R110^3)/(R011*R101*R110)
% s111p = (s300*R011^3 + s030*R101^3 - s003*R110^3)/(R011*R101*R110)
% s111p = (a*s300*R011^3 + b*s030*R101^3 + c*s003*R110^3)/(R011*R101*c*(R110 + (R110*a)/c + (R110*b)/c))





