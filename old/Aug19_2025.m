clear
clc

syms a b c s3 real
syms R110 R101 R011 positive
syms s110 s101 s011 real
syms s210 s201 s120 s102 s021 s012 real
syms s300 s030 s003 s111 real

% a=-1; b=-1; c=-1;
% a=-1; b=1; c=1;
% a=1; b=-1; c=1;
% a=1; b=1; c=-1;

% R110 = sqrt(3/4); R101 = sqrt(3/4); R011 = sqrt(3/4);

% R110 = 1;
% R101 = R011; 
R011 = eps;
s011=1;                                                                
s110=s101;
R110= R101; 

X = [s210 s201 s120 s102 s021 s012 s111 s300 s030 s003]'
%
%1 c*R101*X(1) + b*R110*X(2) - R011*X(8) = 0
%2 c*R011*X(3) + a*R110*X(5) - R101*X(9) = 0
%3 b*R011*X(4) + a*R101*X(6) - R110*X(10)= 0
%4 c*R101*X(5) + b*R110*X(6) - R011*X(7) = 0
%5 c*R011*X(2) + a*R110*X(4) - R101*X(7) = 0
%6 b*R011*X(1) + a*R101*X(3) - R110*X(7) = 0
%7 


B = [0 0 0 0 0 0 0 s300 s030 s003]';

A=sym(zeros(10,10)); 
A(1,1)=c*R101; A(1,2)=b*R110; A(1,8)=-R011;
A(2,3)=c*R011; A(2,5)=a*R110; A(1,9)=-R101;
A(3,4)=b*R011; A(3,6)=a*R101; A(1,10)=-R110;
A(4,5)=c*R101; A(4,6)=b*R110; A(4,7) = -R011;
A(5,2)=c*R011; A(5,4)=a*R110; A(5,7) = -R101; 
A(6,1)=b*R011; A(6,3)=a*R101; A(6,7) = -R110;
A(7,1)=R101; A(7,2)=-R110; A(7,3)=-R011; A(7,4)=R011; A(7,5)=R110; A(7,6)=-R101;
A(8,8)=1;
A(9,9)=1;
A(10,10)=1;

A
rank(A)
rank([A B])

return

Xp = A\B;
Xp = simplify(Xp)

return

[L,U,P] = lu(A)
Ap = P*A
Bp = P*B

[Lp,Up,Pp] = lu(Ap)

Xp = pinv(A)*B;

pretty(Xp)

return

[L,U,P] = lu(A)

Ap = P*A
Bp = P*B

[Lp,Up,Pp] = lu(Ap)

Yp = Lp\Bp
LHS = Up*X
s111p = Yp(6,1)/Up(6,7)

rank(Up(1:6,1:6))

Xp = Up(1:6,1:6)\(Yp(1:6,1)-Up(1:6,7)*s111p)

% s111p = (s300*R011^3 + s030*R101^3 + s003*R110^3)/(3*R011*R101*R110)
% s111p = (- s300*R011^3 + s030*R101^3 + s003*R110^3)/(R011*R101*R110)
% s111p = (s300*R011^3 - s030*R101^3 + s003*R110^3)/(R011*R101*R110)
% s111p = (s300*R011^3 + s030*R101^3 - s003*R110^3)/(R011*R101*R110)
% s111p = (a*s300*R011^3 + b*s030*R101^3 + c*s003*R110^3)/(R011*R101*c*(R110 + (R110*a)/c + (R110*b)/c))





